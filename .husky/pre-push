#!/bin/sh
# .husky/pre-push

# Run critical tests
npm run test:price-db || exit 1
npm run test:security || exit 1

# Validate scrapers aren't exceeding rate limits
npm run validate:rate-limits || exit 1

# Check for incomplete tasks marked as complete
if grep -E "\[x\].*\[BLOCKER\]" TASKS.md | grep -v "#"; then
  echo "⚠️  WARNING: Blocker tasks marked as complete, verify this is correct"
  read -p "Continue push? (y/n) " -n 1 -r
  echo
  if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    exit 1
  fi
fi